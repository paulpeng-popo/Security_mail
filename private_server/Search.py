from charm.toolbox.pairinggroup import PairingGroup
from charm.toolbox.secretutil import SecretUtil
from PEKS.Othertools.utils import *

def search(data, search_key):
	# ======= get encrypted data =======
	groupObj = PairingGroup("MNT224")
	util = SecretUtil(groupObj, False)

	data = base64_to_groupE(data, groupObj)
	search_key = base64_to_groupE(search_key, groupObj)

	policy = util.createPolicy(search_key['policy'])
	attrs = util.prune(policy, data['attributes'])
	if attrs == False: return False
	return True

if __name__ == "__main__":
	chead = "eyJFMSI6ICJNenBDYkhwd1RWUm1hakpvV0RRNVRubHVTekJoTDBKNE1UVlBVelpYV1hseFRIQkdiVEEzVXpSWlRVcGpjRUZ4V0hGTk1qRnRhekp3VkZNemMycE9aVmx5V1d4S1NFODBUM2g2WjFaM2RUaGFiR3hZU0c1VWNXdG5OVmxXT1RWUVFtcENZV2gwYTNGcWFXMUhabGM0ZERWUlNVWjNVa0pZVGxNeFpIZzFhVXQzUjFWS1RIcFRVSFIwVFVkdlFtZHRVSFZyY1cxRE1VVlFORGd2UldGV1ZuaFBTVmh6U0ZKelRrTXdaalkwTjNCdkwxUjNlRlZ5UmpVeWRGRm9SSFZMWlhNdmVrazFNMFUzZFZKQ01rUXpRM2hJYmpkTlZ6ZEpTaXM1VGtjNFZTOVFZUT09IiwgIkUyIjogIk1qcFRaMU5vZHpSVlNHTlJiVUkyUkhNMmIzbEZaM1ZYTVhoNGRFRk5SMjF5Wms1VWQyeHlhR3hFUmtNMU1GcG1OR0pZZFVOMldGQjVSVVpUUTFsM1VtOVJORGRWU25KMlF6WTVXbHA2ZUZvNFpUVTJSMGRqUkZkUWMwTnJSV05vTDFSUFJHdzJZM0J0YWpWblZtVmFRalpvUVZFOVBRPT0iLCAiRTMiOiAiZXlJME9FRXdNVUV4UlVWRk5qVkdOVUV3TWtRMVJEVXpOVGsxTURrM05Ua3dPVGcwTVRnd05UYzROamMzTWpCQ056a3pOa014TWtKQlFpSTZJQ0pOVkhCRVdsUldRMUZwY3pGamFrSTJVa1JPU1ZKRVZtdGlWRXBXWVhwQ1MwMVlZM2xpTWxKUlV6QXhURmxWWkhsUlYxcEhaREJGT1NJc0lDSTNRakUyTTBZNU4wTkNNME0zTWtJelF6VTVOREJGTlRjME9URkJPRUkyUlRFeE5VWTBOVVJDTlRrNU5qSXlRVEU1UVVVd09UWTJSU0k2SUNKTlZIQkRTekJHUWxORVRrTldTR3d6VkhsemQxRXlUbTFhU0ZKYVRWWndibEZWZEZGV2JXc3pVbTVXYTA1c2F6UmlSR3h4VlZWRk9TSXNJQ0kwT0RaRVEwRTVOVVU0TjBZM01qQkRSVVUwTTBWRk9VRTVPVEZGTkRoRk1EUkRPVVF5T0RBeFJUYzBNVGRGUkVFMlJqZEdOakk0UWlJNklDSk5WSEJoVkd0d05GTXdVa2hpUkVJMllsZEZOVmt3TVRGT1dGSXlaRk4wVG1ReFFraFphazB4V1d0V1ZGWlRkRk5qVjFWNlVWVkZPU0lzSUNJek16aENNVFl3UWpJME56YzRNakl6UVVVNE5URTBNelk0TlVNNE9UUXhRamhFT1RFek4wWXpOVGN3TVRBeFFUUTRRVGs1TjBaQ09DSTZJQ0pOVkhCeFdXazVTMlJVWkRSYWEyOTZWV3RLVjFOR2J6TmtNMFV4V1c1T1VGVnJWalpXYlhBMlkxY3hWV0l3VW1GUlZ6VkRWVlZWT1NJc0lDSXdRVUkzUmpGRE5FWkJRMEV5TmpRMU4wWkRSRVF3T1RReVJrWXlRVUpGT0VReU5qQXpRVFpGTTBVMk5FWXpPVVF5TWpVNE9VRXlPQ0k2SUNKTlZIQldUakJ3TW1Sc2NFOWhWR3h4VVZaR2NrMUVhSEJUTTJnMllXeEZNVm94YkVWaWFsWjRWRVJzU1ZWc2JGWlRWelZ6V2pCVk9TSXNJQ0pFUWtJNU5VWXhSalEyUXpZNU9ERTVSRFZFUlRrMlJrVTJPRU00TTBGQk5qaEJOVGd6UkRSRFEwVXpORE5DUVVaR09EaEVOMEUzUkNJNklDSk5WSEJZVkZST1ExVkVRbnBpTTFFMFRWaG9kMkpVUm5CVGJYaHZTek5aTUZNd1dsTldNblF6VjBoQ2RrdDZWbWhVYTBaTFZWVkZPU0lzSUNKQ09Ua3dNamhHTUVOQ01rRTVPRFU1TVVFeE5rVkdNekkxT0VZeE9UZEVSRGMwTlVFNE5qYzFPVFUyUVRjME9VTTVSVFpDUlVKRlFTSTZJQ0pOVkhCRVZHNWFNR0pJVVhkak1qRjVaV3RKTTJOSFdsQmthbXN4VkZoV1UwOVdTbUZSTVVKaFkwaGtVbFl5U1RSU1ZrWkxXakJWT1NJc0lDSkVRMEUzUmtORU5FUkNSa1UxUVRBNU1FUkJSREpETUVJNFJFSTJNRGN5UmtNNFJFTXhRamxHUkRZd1JVWTVORE01TmpZeVJqVTNPU0k2SUNKTlZIQnVXbFpDTUdKVldtdFZhMHBzVm10MFZsVkRkRVZaYWtwRFVteEdXRk5zWnpGa2VrSnVUbFZhVFdWR1drUlhTR2gxVlZWRk9TSjkiLCAiYXR0cmlidXRlcyI6ICI0OEEwMUExRUVFNjVGNUEwMkQ1RDUzNTk1MDk3NTkwOTg0MTgwNTc4Njc3MjBCNzkzNkMxMkJBQiA3QjE2M0Y5N0NCM0M3MkIzQzU5NDBFNTc0OTFBOEI2RTExNUY0NURCNTk5NjIyQTE5QUUwOTY2RSA0ODZEQ0E5NUU4N0Y3MjBDRUU0M0VFOUE5OTFFNDhFMDRDOUQyODAxRTc0MTdFREE2RjdGNjI4QiAzMzhCMTYwQjI0Nzc4MjIzQUU4NTE0MzY4NUM4OTQxQjhEOTEzN0YzNTcwMTAxQTQ4QTk5N0ZCOCAwQUI3RjFDNEZBQ0EyNjQ1N0ZDREQwOTQyRkYyQUJFOEQyNjAzQTZFM0U2NEYzOUQyMjU4OUEyOCBEQkI5NUYxRjQ2QzY5ODE5RDVERTk2RkU2OEM4M0FBNjhBNTgzRDRDQ0UzNDNCQUZGODhEN0E3RCBCOTkwMjhGMENCMkE5ODU5MUExNkVGMzI1OEYxOTdERDc0NUE4Njc1OTU2QTc0OUM5RTZCRUJFQSBEQ0E3RkNENERCRkU1QTA5MERBRDJDMEI4REI2MDcyRkM4REMxQjlGRDYwRUY5NDM5NjYyRjU3OSJ9"
	search_token = "eyJwb2xpY3kiOiAiMGFiN2YxYzRmYWNhMjY0NTdmY2RkMDk0MmZmMmFiZThkMjYwM2E2ZTNlNjRmMzlkMjI1ODlhMjggb3IgNWViMTFhM2Q0NjZmMzAyOWRhNTUxZWFkOWQzNDhkYmFkNmI4OWRkYzJhNTMwZGY2NzJhYTI3MzIgb3IgZGY0ZTY1NjZmN2Q5OTIxZjBlZTgwNjIyMGIwNTEyNDk3NmNjYTg5YzczZWViNmQwMmIwZDllNTIiLCAiMEFCN0YxQzRGQUNBMjY0NTdGQ0REMDk0MkZGMkFCRThEMjYwM0E2RTNFNjRGMzlEMjI1ODlBMjgiOiAiTVRwT1RqUmFiR2R4YlVwbFpXUlBWMHBrVEVSaGNtaGFSblZzZUVSblJGVllUVUp2TTJWRGQwRTkgTWpwcFUwdFFTRmhxY0ZJdlVFMVhXa1E1VnprM1VGQmpNMHhaY0N0TFMxcDZRMnc1VXpkT1NEbExlVzF1YzBjcmQyZERZMFIxTnpSVmVWcFRWSEV5TDFWQmRsUmhjbWxwZG1GdU1VbHlURWR3ZGtoSldVOHZWWE5GYjFSdVowWkdRbTFEZFZwWlZIVkNlVGhwVHpjclRrTlJRVkU5UFE9PSIsICI1RUIxMUEzRDQ2NkYzMDI5REE1NTFFQUQ5RDM0OERCQUQ2Qjg5RERDMkE1MzBERjY3MkFBMjczMiI6ICJNVHBvUWtaVE1IVkhLMGh1TTBjemMzRkxSa3N5WlZJeVUxQkpRM05oVmtoQ1pqWTNXbUZZUVVFOSBNanBHZWtRMlFXd3ZaRUZoYlVsRGREaE9Lek4wWVRSTVNqTmxTRE5rUjNJMVRXVnhNbkZCVTNOdllXaDFWRE4wVkhwSVJteFFSR1pvTlhjMGRURk9jakJ6VUdndmIyMWlabE4yY0d0SGQydHJjWGhPTWs1Q0wyTlNWbVl6ZVU5VWVXZG5XRzFOVEZGU1pHWjNORTVTYjJsblFVRTlQUT09IiwgIkRGNEU2NTY2RjdEOTkyMUYwRUU4MDYyMjBCMDUxMjQ5NzZDQ0E4OUM3M0VFQjZEMDJCMEQ5RTUyIjogIk1UcG1XV1UwTTFNMGIzTjBlR1UwUm5Wd2FIWkxZV1Z1UkZwdWVDczNMMmxJWTI5UmFFVXlVVVU5IE1qcEdWMUJvV1hOV2VXZDBOU3R6V25oR1kySnliVFJrVG5wcWNXNU9ObTl3UmxGUFlWSkhWaTlaTXpOa1RYaHVUWGczWWtkT01ETnFabkV6V2xaRGJHTlRaRlpZTmxZM2IxVnJNMnN6VjNCa1ZsTjJPR040YWxWWU5XOVVNMnQzVGpoS2VrNU9SRzE2Wkd3dlNuVkhSa0V4UVVFOVBRPT0ifQ=="
	result = search(chead, search_token)
	print(result)
